<h1>Listing categories</h1>

<table>
  <tr>
    <th>Name</th>
    <th>Created at</th>
    <th>Updated at</th>
  </tr>

<% @categories.each do |category| %>
  <tr>
    <td>
      <h4><%= link_to category.name, category %></h4>
      <small><%= category.posts.count %> posts</small><br/>
    </td>

    <td>
      <%= distance_of_time_in_words_to_now category.created_at %> ago
    </td>

    <td>
      <% if category.posts.empty? %>
          No post created yet.
      <% else %>
          <%= distance_of_time_in_words_to_now category.posts.first.updated_at %> ago by
          <%= link_to category.posts.first.user.username, category.posts.first.user %>
      <% end %>
    </td>

    <% if signed_in? %>
        <% if current_user.admin? %>
            <td><%= link_to 'Edit', edit_category_path(category) %></td>
            <td><%= link_to 'Delete', category, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
    <% end %>
  </tr>
<% end %>
</table>

<br />

<%= link_to 'New Category', new_category_path %>
